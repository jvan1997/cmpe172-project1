{"ast":null,"code":"var _jsxFileName = \"/Users/jonVan/Desktop/GitHub/CMPE172/test/client/src/components/FacebookButton.js\";\nimport React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\n\nfunction waitForInit() {\n  return new Promise((res, rej) => {\n    const hasFbLoaded = () => {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n\n    hasFbLoaded();\n  });\n}\n\nexport default class FacebookButton extends Component {\n  constructor(props) {\n    super(props);\n\n    this.statusChangeCallback = response => {\n      if (response.status === \"connected\") {\n        console.log(response);\n        this.handleResponse(response.authResponse);\n      } else {\n        this.handleError(response);\n      }\n    };\n\n    this.checkLoginState = () => {\n      window.FB.getLoginStatus(this.statusChangeCallback);\n    };\n\n    this.handleClick = () => {\n      window.FB.login(this.checkLoginState, {\n        scope: \"public_profile,email\"\n      });\n    };\n\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    await waitForInit();\n    this.setState({\n      isLoading: false\n    });\n  }\n\n  handleError(error) {\n    alert(error);\n  }\n\n  async handleResponse(data) {\n    const userId = data.userId,\n          token = data.accessToken,\n          expiresIn = data.expiresIn;\n    const expires_at = expiresIn * 1000 + new Date().getTime();\n    const user = {\n      userId\n    };\n    console.log(userId);\n    console.log(\"data\", data);\n    this.setState({\n      isLoading: true\n    });\n\n    try {\n      const response = await Auth.federatedSignIn(\"facebook\", {\n        token,\n        expires_at\n      }, user);\n      this.setState({\n        isLoading: false\n      });\n      this.props.onLogin(response);\n      console.log(response);\n    } catch (e) {\n      this.setState({\n        isLoading: false\n      });\n      this.handleError(e);\n    }\n  }\n\n  render() {\n    return React.createElement(\"button\", {\n      className: \"mt-4 w-full h-10 bg-blue-700 rounded text-white\",\n      onClick: this.handleClick,\n      disabled: this.state.isLoading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, \"Login with Facebook\");\n  }\n\n}","map":{"version":3,"sources":["/Users/jonVan/Desktop/GitHub/CMPE172/test/client/src/components/FacebookButton.js"],"names":["React","Component","Auth","waitForInit","Promise","res","rej","hasFbLoaded","window","FB","setTimeout","FacebookButton","constructor","props","statusChangeCallback","response","status","console","log","handleResponse","authResponse","handleError","checkLoginState","getLoginStatus","handleClick","login","scope","state","isLoading","componentDidMount","setState","error","alert","data","userId","token","accessToken","expiresIn","expires_at","Date","getTime","user","federatedSignIn","onLogin","e","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\n\nfunction waitForInit() {\n  return new Promise((res, rej) => {\n    const hasFbLoaded = () => {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n    hasFbLoaded();\n  });\n}\n\nexport default class FacebookButton extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    await waitForInit();\n    this.setState({ isLoading: false });\n  }\n\n  statusChangeCallback = response => {\n    if (response.status === \"connected\") {\n        console.log(response);\n      this.handleResponse(response.authResponse);\n    } else {\n      this.handleError(response);\n    }\n  };\n\n  checkLoginState = () => {\n    window.FB.getLoginStatus(this.statusChangeCallback);\n  };\n\n  handleClick = () => {\n    window.FB.login(this.checkLoginState, {scope: \"public_profile,email\"});\n  };\n\n  handleError(error) {\n    alert(error);\n  }\n\n  async handleResponse(data) {\n    const { userId, accessToken: token, expiresIn } = data;\n    const expires_at = expiresIn * 1000 + new Date().getTime();\n    const user = { userId };\n    console.log(userId);\n    console.log(\"data\", data);\n    this.setState({ isLoading: true });\n\n    try {\n      const response = await Auth.federatedSignIn(\n        \"facebook\",\n        { token, expires_at },\n        user\n      );\n      this.setState({ isLoading: false });\n      this.props.onLogin(response);\n      console.log(response);\n    } catch (e) {\n      this.setState({ isLoading: false });\n      this.handleError(e);\n    }\n  }\n\n  render() {\n    return (\n      <button\n        className=\"mt-4 w-full h-10 bg-blue-700 rounded text-white\"\n        onClick={this.handleClick}\n        disabled={this.state.isLoading}\n      >Login with Facebook</button>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}