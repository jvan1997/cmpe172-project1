{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jonVan/Desktop/GitHub/cmpe172-project1/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jonVan/Desktop/GitHub/cmpe172-project1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/jonVan/Desktop/GitHub/cmpe172-project1/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jonVan/Desktop/GitHub/cmpe172-project1/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/jonVan/Desktop/GitHub/cmpe172-project1/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/jonVan/Desktop/GitHub/cmpe172-project1/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/jonVan/Desktop/GitHub/cmpe172-project1/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{Auth}from\"aws-amplify\";function waitForInit(){return new Promise(function(res,rej){var hasFbLoaded=function hasFbLoaded(){if(window.FB){res();}else{setTimeout(hasFbLoaded,300);}};hasFbLoaded();});}var FacebookButton=/*#__PURE__*/function(_Component){_inherits(FacebookButton,_Component);function FacebookButton(props){var _this;_classCallCheck(this,FacebookButton);_this=_possibleConstructorReturn(this,_getPrototypeOf(FacebookButton).call(this,props));_this.statusChangeCallback=function(response){if(response.status===\"connected\"){console.log(response);_this.handleResponse(response.authResponse);}else{_this.handleError(response);}};_this.checkLoginState=function(){window.FB.getLoginStatus(_this.statusChangeCallback);};_this.handleClick=function(){window.FB.login(_this.checkLoginState,{scope:\"public_profile,email\"});};_this.state={isLoading:true};return _this;}_createClass(FacebookButton,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return waitForInit();case 2:this.setState({isLoading:false});case 3:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"handleError\",value:function handleError(error){alert(error);}},{key:\"handleResponse\",value:function(){var _handleResponse=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var userID,token,expiresIn,expires_at,user,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:userID=data.userID,token=data.accessToken,expiresIn=data.expiresIn;expires_at=expiresIn*1000+new Date().getTime();user={userID:userID};console.log(userID);console.log(\"data\",data);this.setState({isLoading:true});_context2.prev=6;_context2.next=9;return Auth.federatedSignIn(\"facebook\",{token:token,expires_at:expires_at},user);case 9:response=_context2.sent;this.setState({isLoading:false});this.props.onLogin(response);console.log(response);_context2.next=19;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](6);this.setState({isLoading:false});this.handleError(_context2.t0);case 19:case\"end\":return _context2.stop();}}},_callee2,this,[[6,15]]);}));function handleResponse(_x){return _handleResponse.apply(this,arguments);}return handleResponse;}()},{key:\"render\",value:function render(){return React.createElement(\"button\",{className:\"mt-4 w-full h-10 bg-blue-700 rounded text-white\",onClick:this.handleClick,disabled:this.state.isLoading},\"Login with Facebook\");}}]);return FacebookButton;}(Component);export{FacebookButton as default};","map":{"version":3,"sources":["/Users/jonVan/Desktop/GitHub/cmpe172-project1/src/components/FacebookButton.js"],"names":["React","Component","Auth","waitForInit","Promise","res","rej","hasFbLoaded","window","FB","setTimeout","FacebookButton","props","statusChangeCallback","response","status","console","log","handleResponse","authResponse","handleError","checkLoginState","getLoginStatus","handleClick","login","scope","state","isLoading","setState","error","alert","data","userID","token","accessToken","expiresIn","expires_at","Date","getTime","user","federatedSignIn","onLogin"],"mappings":"24BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,IAAT,KAAqB,aAArB,CAEA,QAASC,CAAAA,WAAT,EAAuB,CACrB,MAAO,IAAIC,CAAAA,OAAJ,CAAY,SAACC,GAAD,CAAMC,GAAN,CAAc,CAC/B,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxB,GAAIC,MAAM,CAACC,EAAX,CAAe,CACbJ,GAAG,GACJ,CAFD,IAEO,CACLK,UAAU,CAACH,WAAD,CAAc,GAAd,CAAV,CACD,CACF,CAND,CAOAA,WAAW,GACZ,CATM,CAAP,CAUD,C,GAEoBI,CAAAA,c,wEACnB,wBAAYC,KAAZ,CAAmB,gDACjB,gFAAMA,KAAN,GADiB,MAanBC,oBAbmB,CAaI,SAAAC,QAAQ,CAAI,CACjC,GAAIA,QAAQ,CAACC,MAAT,GAAoB,WAAxB,CAAqC,CACjCC,OAAO,CAACC,GAAR,CAAYH,QAAZ,EACF,MAAKI,cAAL,CAAoBJ,QAAQ,CAACK,YAA7B,EACD,CAHD,IAGO,CACL,MAAKC,WAAL,CAAiBN,QAAjB,EACD,CACF,CApBkB,OAsBnBO,eAtBmB,CAsBD,UAAM,CACtBb,MAAM,CAACC,EAAP,CAAUa,cAAV,CAAyB,MAAKT,oBAA9B,EACD,CAxBkB,OA0BnBU,WA1BmB,CA0BL,UAAM,CAClBf,MAAM,CAACC,EAAP,CAAUe,KAAV,CAAgB,MAAKH,eAArB,CAAsC,CAACI,KAAK,CAAE,sBAAR,CAAtC,EACD,CA5BkB,CAGjB,MAAKC,KAAL,CAAa,CACXC,SAAS,CAAE,IADA,CAAb,CAHiB,aAMlB,C,+SAGOxB,CAAAA,WAAW,E,QACjB,KAAKyB,QAAL,CAAc,CAAED,SAAS,CAAE,KAAb,CAAd,E,wNAoBUE,K,CAAO,CACjBC,KAAK,CAACD,KAAD,CAAL,CACD,C,uIAEoBE,I,0KACXC,M,CAA0CD,I,CAA1CC,M,CAAqBC,K,CAAqBF,I,CAAlCG,W,CAAoBC,S,CAAcJ,I,CAAdI,S,CAC9BC,U,CAAaD,SAAS,CAAG,IAAZ,CAAmB,GAAIE,CAAAA,IAAJ,GAAWC,OAAX,E,CAChCC,I,CAAO,CAAEP,MAAM,CAANA,MAAF,C,CACbhB,OAAO,CAACC,GAAR,CAAYe,MAAZ,EACAhB,OAAO,CAACC,GAAR,CAAY,MAAZ,CAAoBc,IAApB,EACA,KAAKH,QAAL,CAAc,CAAED,SAAS,CAAE,IAAb,CAAd,E,wCAGyBzB,CAAAA,IAAI,CAACsC,eAAL,CACrB,UADqB,CAErB,CAAEP,KAAK,CAALA,KAAF,CAASG,UAAU,CAAVA,UAAT,CAFqB,CAGrBG,IAHqB,C,QAAjBzB,Q,gBAKN,KAAKc,QAAL,CAAc,CAAED,SAAS,CAAE,KAAb,CAAd,EACA,KAAKf,KAAL,CAAW6B,OAAX,CAAmB3B,QAAnB,EACAE,OAAO,CAACC,GAAR,CAAYH,QAAZ,E,qFAEA,KAAKc,QAAL,CAAc,CAAED,SAAS,CAAE,KAAb,CAAd,EACA,KAAKP,WAAL,e,oNAIK,CACP,MACE,+BACE,SAAS,CAAC,iDADZ,CAEE,OAAO,CAAE,KAAKG,WAFhB,CAGE,QAAQ,CAAE,KAAKG,KAAL,CAAWC,SAHvB,wBADF,CAOD,C,4BAlEyC1B,S,SAAvBU,c","sourcesContent":["import React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\n\nfunction waitForInit() {\n  return new Promise((res, rej) => {\n    const hasFbLoaded = () => {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n    hasFbLoaded();\n  });\n}\n\nexport default class FacebookButton extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    await waitForInit();\n    this.setState({ isLoading: false });\n  }\n\n  statusChangeCallback = response => {\n    if (response.status === \"connected\") {\n        console.log(response);\n      this.handleResponse(response.authResponse);\n    } else {\n      this.handleError(response);\n    }\n  };\n\n  checkLoginState = () => {\n    window.FB.getLoginStatus(this.statusChangeCallback);\n  };\n\n  handleClick = () => {\n    window.FB.login(this.checkLoginState, {scope: \"public_profile,email\"});\n  };\n\n  handleError(error) {\n    alert(error);\n  }\n\n  async handleResponse(data) {\n    const { userID, accessToken: token, expiresIn } = data;\n    const expires_at = expiresIn * 1000 + new Date().getTime();\n    const user = { userID };\n    console.log(userID);\n    console.log(\"data\", data);\n    this.setState({ isLoading: true });\n    \n    try {\n      const response = await Auth.federatedSignIn(\n        \"facebook\",\n        { token, expires_at },\n        user\n      );\n      this.setState({ isLoading: false });\n      this.props.onLogin(response);\n      console.log(response);\n    } catch (e) {\n      this.setState({ isLoading: false });\n      this.handleError(e);\n    }\n  }\n\n  render() {\n    return (\n      <button\n        className=\"mt-4 w-full h-10 bg-blue-700 rounded text-white\"\n        onClick={this.handleClick}\n        disabled={this.state.isLoading}\n      >Login with Facebook</button>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}