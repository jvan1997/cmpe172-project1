{"ast":null,"code":"var _jsxFileName = \"/Users/jonVan/Desktop/GitHub/CMPE172/test/client/src/components/FacebookButton.js\";\nimport React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\n\nfunction waitForInit() {\n  return new Promise((res, rej) => {\n    const hasFbLoaded = () => {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n\n    hasFbLoaded();\n  });\n}\n\nexport default class FacebookButton extends Component {\n  constructor(props) {\n    super(props);\n\n    this.statusChangeCallback = response => {\n      if (response.status === \"connected\") {\n        this.handleResponse(response.authResponse);\n      } else {\n        this.handleError(response);\n      }\n    };\n\n    this.checkLoginState = () => {\n      window.FB.getLoginStatus(this.statusChangeCallback);\n    };\n\n    this.handleClick = () => {\n      window.FB.login(this.checkLoginState, {\n        scope: \"public_profile,email\"\n      });\n    };\n\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    await waitForInit();\n    this.setState({\n      isLoading: false\n    });\n  }\n\n  handleError(error) {\n    alert(error);\n  }\n\n  async handleResponse(data) {\n    const email = data.email,\n          token = data.accessToken,\n          expiresIn = data.expiresIn;\n    const expires_at = expiresIn * 1000 + new Date().getTime();\n    const user = {\n      email\n    };\n    this.setState({\n      isLoading: true\n    });\n\n    try {\n      const response = await Auth.federatedSignIn(\"facebook\", {\n        token,\n        expires_at\n      }, user);\n      this.setState({\n        isLoading: false\n      });\n      this.props.onLogin(response);\n    } catch (e) {\n      this.setState({\n        isLoading: false\n      });\n      this.handleError(e);\n    }\n  }\n\n  render() {\n    return React.createElement(\"button\", {\n      className: \"w-1/4 h-10 bg-blue-700 rounded\",\n      text: \"Login with Facebook\",\n      onClick: this.handleClick,\n      disabled: this.state.isLoading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/jonVan/Desktop/GitHub/CMPE172/test/client/src/components/FacebookButton.js"],"names":["React","Component","Auth","waitForInit","Promise","res","rej","hasFbLoaded","window","FB","setTimeout","FacebookButton","constructor","props","statusChangeCallback","response","status","handleResponse","authResponse","handleError","checkLoginState","getLoginStatus","handleClick","login","scope","state","isLoading","componentDidMount","setState","error","alert","data","email","token","accessToken","expiresIn","expires_at","Date","getTime","user","federatedSignIn","onLogin","e","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,IAAT,QAAqB,aAArB;;AAEA,SAASC,WAAT,GAAuB;AACrB,SAAO,IAAIC,OAAJ,CAAY,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC/B,UAAMC,WAAW,GAAG,MAAM;AACxB,UAAIC,MAAM,CAACC,EAAX,EAAe;AACbJ,QAAAA,GAAG;AACJ,OAFD,MAEO;AACLK,QAAAA,UAAU,CAACH,WAAD,EAAc,GAAd,CAAV;AACD;AACF,KAND;;AAOAA,IAAAA,WAAW;AACZ,GATM,CAAP;AAUD;;AAED,eAAe,MAAMI,cAAN,SAA6BV,SAA7B,CAAuC;AACpDW,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAanBC,oBAbmB,GAaIC,QAAQ,IAAI;AACjC,UAAIA,QAAQ,CAACC,MAAT,KAAoB,WAAxB,EAAqC;AACnC,aAAKC,cAAL,CAAoBF,QAAQ,CAACG,YAA7B;AACD,OAFD,MAEO;AACL,aAAKC,WAAL,CAAiBJ,QAAjB;AACD;AACF,KAnBkB;;AAAA,SAqBnBK,eArBmB,GAqBD,MAAM;AACtBZ,MAAAA,MAAM,CAACC,EAAP,CAAUY,cAAV,CAAyB,KAAKP,oBAA9B;AACD,KAvBkB;;AAAA,SAyBnBQ,WAzBmB,GAyBL,MAAM;AAClBd,MAAAA,MAAM,CAACC,EAAP,CAAUc,KAAV,CAAgB,KAAKH,eAArB,EAAsC;AAACI,QAAAA,KAAK,EAAE;AAAR,OAAtC;AACD,KA3BkB;;AAGjB,SAAKC,KAAL,GAAa;AACXC,MAAAA,SAAS,EAAE;AADA,KAAb;AAGD;;AAED,QAAMC,iBAAN,GAA0B;AACxB,UAAMxB,WAAW,EAAjB;AACA,SAAKyB,QAAL,CAAc;AAAEF,MAAAA,SAAS,EAAE;AAAb,KAAd;AACD;;AAkBDP,EAAAA,WAAW,CAACU,KAAD,EAAQ;AACjBC,IAAAA,KAAK,CAACD,KAAD,CAAL;AACD;;AAED,QAAMZ,cAAN,CAAqBc,IAArB,EAA2B;AAAA,UACjBC,KADiB,GACwBD,IADxB,CACjBC,KADiB;AAAA,UACGC,KADH,GACwBF,IADxB,CACVG,WADU;AAAA,UACUC,SADV,GACwBJ,IADxB,CACUI,SADV;AAEzB,UAAMC,UAAU,GAAGD,SAAS,GAAG,IAAZ,GAAmB,IAAIE,IAAJ,GAAWC,OAAX,EAAtC;AACA,UAAMC,IAAI,GAAG;AAAEP,MAAAA;AAAF,KAAb;AAEA,SAAKJ,QAAL,CAAc;AAAEF,MAAAA,SAAS,EAAE;AAAb,KAAd;;AAEA,QAAI;AACF,YAAMX,QAAQ,GAAG,MAAMb,IAAI,CAACsC,eAAL,CACrB,UADqB,EAErB;AAAEP,QAAAA,KAAF;AAASG,QAAAA;AAAT,OAFqB,EAGrBG,IAHqB,CAAvB;AAKA,WAAKX,QAAL,CAAc;AAAEF,QAAAA,SAAS,EAAE;AAAb,OAAd;AACA,WAAKb,KAAL,CAAW4B,OAAX,CAAmB1B,QAAnB;AACD,KARD,CAQE,OAAO2B,CAAP,EAAU;AACV,WAAKd,QAAL,CAAc;AAAEF,QAAAA,SAAS,EAAE;AAAb,OAAd;AACA,WAAKP,WAAL,CAAiBuB,CAAjB;AACD;AACF;;AAEDC,EAAAA,MAAM,GAAG;AACP,WACE;AACE,MAAA,SAAS,EAAC,gCADZ;AAEE,MAAA,IAAI,EAAC,qBAFP;AAGE,MAAA,OAAO,EAAE,KAAKrB,WAHhB;AAIE,MAAA,QAAQ,EAAE,KAAKG,KAAL,CAAWC,SAJvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AAQD;;AAhEmD","sourcesContent":["import React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\n\nfunction waitForInit() {\n  return new Promise((res, rej) => {\n    const hasFbLoaded = () => {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n    hasFbLoaded();\n  });\n}\n\nexport default class FacebookButton extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    await waitForInit();\n    this.setState({ isLoading: false });\n  }\n\n  statusChangeCallback = response => {\n    if (response.status === \"connected\") {\n      this.handleResponse(response.authResponse);\n    } else {\n      this.handleError(response);\n    }\n  };\n\n  checkLoginState = () => {\n    window.FB.getLoginStatus(this.statusChangeCallback);\n  };\n\n  handleClick = () => {\n    window.FB.login(this.checkLoginState, {scope: \"public_profile,email\"});\n  };\n\n  handleError(error) {\n    alert(error);\n  }\n\n  async handleResponse(data) {\n    const { email, accessToken: token, expiresIn } = data;\n    const expires_at = expiresIn * 1000 + new Date().getTime();\n    const user = { email };\n\n    this.setState({ isLoading: true });\n\n    try {\n      const response = await Auth.federatedSignIn(\n        \"facebook\",\n        { token, expires_at },\n        user\n      );\n      this.setState({ isLoading: false });\n      this.props.onLogin(response);\n    } catch (e) {\n      this.setState({ isLoading: false });\n      this.handleError(e);\n    }\n  }\n\n  render() {\n    return (\n      <button\n        className=\"w-1/4 h-10 bg-blue-700 rounded\"\n        text=\"Login with Facebook\"\n        onClick={this.handleClick}\n        disabled={this.state.isLoading}\n      />\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}