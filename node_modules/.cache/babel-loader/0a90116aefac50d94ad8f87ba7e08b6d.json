{"ast":null,"code":"var _jsxFileName = \"/Users/jonVan/Desktop/GitHub/CMPE172/test/client/src/components/FacebookButton.js\";\nimport React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\n\nfunction waitForInit() {\n  return new Promise((res, rej) => {\n    const hasFbLoaded = () => {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n\n    hasFbLoaded();\n  });\n}\n\nexport default class FacebookButton extends Component {\n  constructor(props) {\n    super(props);\n\n    this.statusChangeCallback = response => {\n      if (response.status === \"connected\") {\n        console.log(response);\n        window.FB.api('/me', function (info) {\n          console.log('Getting name' + info.name + '.');\n          let fulname = info.name.split();\n          response.authResponse.name = fulname[0];\n          response.authResponse.lastname = fulname[1 || ''];\n          this.handleResponse(response.authResponse);\n        }).bind(this);\n      } else {\n        this.handleError(response);\n      }\n    };\n\n    this.checkLoginState = () => {\n      window.FB.getLoginStatus(this.statusChangeCallback);\n    };\n\n    this.handleClick = () => {\n      window.FB.login(this.checkLoginState, {\n        scope: \"public_profile,email\"\n      });\n    };\n\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    await waitForInit();\n    this.setState({\n      isLoading: false\n    });\n  }\n\n  handleError(error) {\n    alert(error);\n  }\n\n  async handleResponse(data) {\n    const userID = data.userID,\n          token = data.accessToken,\n          expiresIn = data.expiresIn;\n    const expires_at = expiresIn * 1000 + new Date().getTime();\n    const user = {\n      userID\n    };\n    console.log(userID);\n    console.log(\"data\", data);\n    this.setState({\n      isLoading: true\n    });\n\n    try {\n      const response = await Auth.federatedSignIn(\"facebook\", {\n        token,\n        expires_at\n      }, user);\n      this.setState({\n        isLoading: false\n      });\n      this.props.onLogin(response);\n      console.log(response);\n    } catch (e) {\n      this.setState({\n        isLoading: false\n      });\n      this.handleError(e);\n    }\n  }\n\n  render() {\n    return React.createElement(\"button\", {\n      className: \"mt-4 w-full h-10 bg-blue-700 rounded text-white\",\n      onClick: this.handleClick,\n      disabled: this.state.isLoading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \"Login with Facebook\");\n  }\n\n}","map":{"version":3,"sources":["/Users/jonVan/Desktop/GitHub/CMPE172/test/client/src/components/FacebookButton.js"],"names":["React","Component","Auth","waitForInit","Promise","res","rej","hasFbLoaded","window","FB","setTimeout","FacebookButton","constructor","props","statusChangeCallback","response","status","console","log","api","info","name","fulname","split","authResponse","lastname","handleResponse","bind","handleError","checkLoginState","getLoginStatus","handleClick","login","scope","state","isLoading","componentDidMount","setState","error","alert","data","userID","token","accessToken","expiresIn","expires_at","Date","getTime","user","federatedSignIn","onLogin","e","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\n\nfunction waitForInit() {\n  return new Promise((res, rej) => {\n    const hasFbLoaded = () => {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n    hasFbLoaded();\n  });\n}\n\nexport default class FacebookButton extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    await waitForInit();\n    this.setState({ isLoading: false });\n  }\n\n  statusChangeCallback = response => {\n    if (response.status === \"connected\") {\n        console.log(response);\n        window.FB.api('/me', function(info) {\n                console.log('Getting name' + info.name + '.');\n                let fulname= info.name.split();\n                response.authResponse.name = fulname[0];\n                response.authResponse.lastname = fulname[1 || ''];\n                this.handleResponse(response.authResponse);\n\n            }).bind(this);\n    } else {\n      this.handleError(response);\n    }\n  };\n\n  checkLoginState = () => {\n    window.FB.getLoginStatus(this.statusChangeCallback);\n  };\n\n  handleClick = () => {\n    window.FB.login(this.checkLoginState, {scope: \"public_profile,email\"});\n  };\n\n  handleError(error) {\n    alert(error);\n  }\n\n  async handleResponse(data) {\n    const { userID, accessToken: token, expiresIn } = data;\n    const expires_at = expiresIn * 1000 + new Date().getTime();\n    const user = { userID };\n    console.log(userID);\n    console.log(\"data\", data);\n    this.setState({ isLoading: true });\n\n    try {\n      const response = await Auth.federatedSignIn(\n        \"facebook\",\n        { token, expires_at },\n        user\n      );\n      this.setState({ isLoading: false });\n      this.props.onLogin(response);\n      console.log(response);\n    } catch (e) {\n      this.setState({ isLoading: false });\n      this.handleError(e);\n    }\n  }\n\n  render() {\n    return (\n      <button\n        className=\"mt-4 w-full h-10 bg-blue-700 rounded text-white\"\n        onClick={this.handleClick}\n        disabled={this.state.isLoading}\n      >Login with Facebook</button>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}